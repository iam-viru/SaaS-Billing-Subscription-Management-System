<div class="dashboard-container">

  <div class="page-header">
    <h1>Dashboard Overview</h1>
    <p class="subtitle">Live metrics from customers and invoices</p>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">

    <div class="card kpi-card">
      <div class="kpi-label">Total Customers</div>
      <div class="kpi-value">{{ metrics.totalCustomers }}</div>
      <div class="kpi-sub">Customers in the system</div>
    </div>

    <div class="card kpi-card">
      <div class="kpi-label">Active Customers</div>
      <div class="kpi-value">{{ metrics.activeCustomers }}</div>
      <div class="kpi-sub">{{ metrics.activeCustomers }} active</div>
    </div>

    <div class="card kpi-card">
      <div class="kpi-label">MRR</div>
      <div class="kpi-value">${{ metrics.monthlyRecurringRevenue }}</div>
      <div class="kpi-sub">Monthly recurring revenue</div>
    </div>

    <div class="card kpi-card">
      <div class="kpi-label">Pending Invoices</div>
      <div class="kpi-value">${{ metrics.pendingInvoicesAmount }}</div>
    </div>

    <div class="card kpi-card warning">
      <div class="kpi-label">Overdue</div>
      <div class="kpi-value">
        {{ metrics.overdueInvoicesCount }} / ${{ metrics.overdueInvoicesAmount }}
      </div>
      <div class="kpi-sub">Count / Amount</div>
    </div>

    <div class="card kpi-card">
      <div class="kpi-label">Paid (Total)</div>
      <div class="kpi-value">${{ metrics.paidInvoicesAmount }}</div>
    </div>
  </div>

  <!-- Charts + Recent Invoices -->
  <div class="bottom-grid">

    <!-- Recent Invoices -->
    <div class="card recent-card">
      <h2>Recent Invoices</h2>

      <table class="table small-table">
        <thead>
          <tr>
            <th>Invoice</th>
            <th>Customer</th>
            <th>Status</th>
            <th>Amount</th>
            <th>Issued</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let inv of recentInvoices">
            <td class="strong">{{ inv.invoiceNumber }}</td>
            <td>
              {{ inv.customerName }}
              <div class="sub">{{ inv.customerEmail }}</div>
            </td>
            <td>
              <span class="pill"
                [class.pending]="inv.status === 'Pending'"
                [class.overdue]="inv.status === 'Overdue'">
                {{ inv.status }}
              </span>
            </td>
            <td>{{ inv.currency }} {{ inv.amount }}</td>
            <td>{{ inv.issueDate | date:'mediumDate' }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Charts Section -->
    <div class="card chart-card">
      <h2>Revenue & Customers</h2>

      <div class="charts-grid">

        <!-- Line Chart -->
        <div class="chart-block">
          <h3 class="chart-title">Revenue by Month</h3>

 <canvas
  baseChart
  [data]="revenueChartData"
  [options]="revenueChartOptions"
  type="line">
</canvas>


        </div>

        <!-- Doughnut Chart -->
        <div class="chart-block">
          <h3 class="chart-title">Active Customers by Plan</h3>

          <canvas
            baseChart
            [data]="planChartData"
            [options]="planChartOptions"
            type="doughnut">
          </canvas>
        </div>

      </div>
    </div>
  </div>
</div>
